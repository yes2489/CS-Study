# OSI 7계층

## OSI 7계층의 개요
 - Open Systems Interconnection 7 Layer의 약어로 국제 표준화 기구(ISO)에서 개발한 표준화된 네트워크 구조 모델
 - 이기종간의 연결이 가능하도록 하게 해주는 표준
 - 7개의 계층으로 존재하며 서로 독립적이므로 어느 한 계층의 변경이 다른 계층에 영향을 미치지 않음

## OSI 7계층의 데이터 전송

### 프로토콜 데이터 단위 (PDU)
 - 송신 측이나 수신 측의 다음 계층에 데이터 정보를 전송할 때 사용

### 캡슐화 (Encapsulation)
 - **송신** 측에서 데이터를 보낼 때 데이터의 앞부분에 본인 계층의 정보(헤더)를 붙여 다음 계층으로 전송하는 것

### 역캡슐화 (Decapsulation)
 - **수신** 측에서 자기 계층에 해당하는 헤더를 읽고 해석

### 캡슐화 & 역캡슐화 장점
 - 1. 다른 모듈에 미치는 영향이 최소화
 - 2. 각 계층에 맞는 헤더만 해석되기 때문에 목적에 부합하는 기능만 수행
 - 3. 네트워크 동일 계층 간 호환성이 유지 됨

## 물리계층 (Layer 1)
 - 시스템 간의 물리적인 연결을 위한 계층
 - **전기 신호**로 변환된 데이터들을 전송 매체를 이용해 전달하는 계층
 - 물리계층의 장비 : 리피터, 더미 허브 (← 신호를 증폭시켜주는 리피터의 역할을 하며 대상을 지정할 수 없어 모든 포트에 브로드 캐스트 패킷 전달)
 - PDU : `Bit`

## 데이터링크계층 (Layer 2)
 - **MAC 주소**를 사용하여 통신
 - Point to Point 간 데이터 전송을 담당하며 흐름 제어, 오류 제어 기능이 존재
 - `Ethernet` : MAC 주소를 통해 식별하는 유선 네트워크 구성 방식
 - 데이터링크의 장비 : 스위치 (Switch)
 - PDU : `Frame` - 헤더, 데이터(페이로드), 트레일러로 구성
 ### MAC (Midea Access Control Address)
    - 데이터 링크 계층에서 통신을 위한 **NIC**에 할당된 **고유 식별자**
    - 16진수로 표현하며, 총 6 byte (= 48bit)
 ### ARP 
 - 주소 결정 프로토콜로 해당 IP에 맞는 MAC 주소를 가지고 옴

## 네트워크계층 (Layer 3)
 - **IP**로 통신
 - 네트워크 대역 간에 신뢰성 있는 정보 전송
 - 라우팅, 흐름 제어, 오류 제어 등을 수행
 - 네트워크계층의 장비 : 라우터
 - PDU : `Packet` 또는 `Datagram`
 ### IP(Internert Protocol)
    - 네트워크 계층에서 사용되는 프로토콜
    - 장치간 데이터 패킷을 전송하고 라우팅을 하는데 사용
    - 인터넷에 사용되는 기본 프로토콜
    - 논리 주소인 IP 주소를 부여
    - IPv4와 IPv6가 존재
 ### 단편화(Fragment)
    - 커다란 패킷을 나누어 보내는 작업
    - IP 헤더의 identification과 IP Flags, Fragment offset을 이용
 ### IP 주소
    - IPv4는 8 bit의 수 4개, 4 byte로 구성
    - IPV6는 16 bit의 수 8개, 16 byte로 구성
    - IP주소는 네트워크의 호스트를 식별하는 주소
    [사설IP대역 : 사설 네트워크 대역에서 IP 설정 시 해당 대역으로 설정을 약속하고 사용]
    - A클래스 : 10.0.0.0/8
    - B클래스 : 172.16.0.0/12
    - C클래스 : 192.168.0.0/16
    [공인IP대역]
    - A클래스 : 0.0.0.0 ~ 9.255.255.255 | 11.0.0.0 ~ 127.255.255.255
    - B클래스 : 128.0.0.0 ~ 172.15.255.255 | 172.32.0.0 ~ 191.255.255.255
    - C클래스 : 192.0.0.0 ~ 192.167.255.255 | 192.169.0.0 ~ 223.255.255.255
    - D클래스 : 224.0.0.0 ~ 239.255.255.255
    - E클래스 : 240.0.0.0 ~ 255.255.255.255

## 전송계층 (Layer 4)
 - TCP나 UDP에서 어플리케이션이 상호 통신을 위해 `Port`라는 가상의 논리적 통신 연결단을 사용함
 - 데이터가 제대로 도착했는지 확인
 - 데이터가 최종적으로 도착할 어플리케이션이 무엇인지 식별
 - PDU : `Segment`
 ### TCP & UDP
 <table>
   <thead>
      <tr>
         <th>서비스</th>
         <th>TCP</th>
         <th>UDP</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <td>신뢰성</td>
         <td>신뢰성 O : 패킷이 목적지에 도달했는지 확인, 도달 할 때 마다 ACK 패킷을 수신하기 때문</td>
         <td>신뢰성 X : 패킷이 목적지에 도달했는 지 미확인</td>
      </tr>
      <tr>
         <td>연결</td>
         <td>연결 지향 : 세션 성립 및 종료 시 HandShake 과정 수행, 목적지와 세션 성립</td>
         <td>비연결 지향 : 세션 성립 및 종료 시 HandShake 과정 미수행</td>
      </tr>
      <tr>
         <td>패킷 순서</td>
         <td>패킷 내 순서 번호 사용하여 각 패킷들을 순차적으로 수신. 중간에 유실된 패킷 발생 시 수신측에서 전체 패킷 재전송 요청</td>
         <td>패킷 내 순서번호 미사용</td>
      </tr>
      <tr>
         <td>주 사용</td>
         <td>HTTP, SSH, FTP 등 신뢰성이 필요한 통신에서 주로 사용됨</td>
         <td>실시간 영상, 브로드캐스트 등 신뢰성보다 빠른 통신 필요 시 사용</td>
      </tr>
   </tbody>
 </table>

 ### TCP 3-Way Handshake
 1. 서버는 서비스할 PORT를 열어놓고 Client의 접속을 대기 (closed → listen)
 2. Client는 서버에게 접속 요청하는 SYN 발신 (closed → SYN sent)
 3. 서버는 Client에게 SYN + ACK 발신 (listen → SYN rcvd)
 4. Client는 서버에게 ACK 발신 (SYN sent → established)
 5. 세션 성립 (서버측 SYN rcvd → established)

## 세션계층 (Layer 5)
 - 응용 프로그램 계층 간의 통신을 제어하는 구조를 제공하려고 응용 프로그램 계층 사이의 접속을 설정, 유지, 종료 시켜주는 역할
 - 사용자와 전송 계층 간의 인터페이스 역할을 하며, LAN 사용자가 서버에 접속할 때 이를 관리하는 기능 수행
 - PDU : `Data`

## 표현계층 (Layer 6)
 - 응용 프로그램 간 데이터 변환을 담당
 - 네트워크로 전송된 데이터 형식(Format)을 결정
 - 데이터 압축 및 암호화 기능 제공
 - PDU : `Data`

## 응용계층 (Layer 7)
 - 파일 전송, 데이터베이스, 원격 접속, 이메일 전송 등 응용 서비스를 네트워크에 접속시키는 역할
 - 사용자에게 정보를 입력받아 하위계층으로 전달하고, 하위 계층에서 전송한 데이터를 사용자에게 전달
 - PDU : `Data`